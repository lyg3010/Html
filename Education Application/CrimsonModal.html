<tr>
    <td colspan="2" rowspan="1" class="clearfix cell">
        <div class="modal fade" id="CrimsonModal">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button aria-label="Close" class="form-close" data-dismiss="modal" tabindex="0" title="Close" type="button">
                            <span aria-hidden="true">×</span>
                            <span class="sr-only">Close</span>
                        </button>
                        <h1 class="modal-title" title="Create">
                            <span class="fa fa-pencil-square-o" aria-hidden="true" data-original-title="" title=""></span> Create</h1>
                    </div>
                    <div class="modal-body">
                        <div class="form-loading" style="display: none;">
                            <span class="fa fa-spinner fa-spin fa-4x" aria-hidden="true" data-original-title="" title=""></span>
                        </div>
                        <iframe id="CrimsonIframe" style="border-width: 0px;width: 100%;height: 543px;"></iframe>
                    </div>
                </div>
            </div>
        </div>
        <a href="#" class="btn btn-primary action create-action" title="Create" id="UploadButton">Upload Document</a>
    </td>
    <td class="cell zero-cell"></td>
</tr>


$("#ccl1007_havecv_label").parent().parent().parent().after('<tr> <td colspan="2" rowspan="1" class="clearfix cell"> <div class="modal fade" id="CrimsonModal"> <div class="modal-dialog"> <div class="modal-content"> <div class="modal-header"> <button aria-label="Close" class="form-close" data-dismiss="modal" tabindex="0" title="Close" type="button"> <span aria-hidden="true">×</span> <span class="sr-only">Close</span> </button> <h1 class="modal-title" title="Create"> <span class="fa fa-pencil-square-o" aria-hidden="true" data-original-title="" title=""></span> Create</h1> </div> <div class="modal-body"> <div class="form-loading" style="display: none;"> <span class="fa fa-spinner fa-spin fa-4x" aria-hidden="true" data-original-title="" title=""></span> </div> <iframe id="CrimsonIframe" style="border-width: 0px;width: 100%;height: 543px;"></iframe> </div> </div> </div> </div> <a href="#" class="btn btn-primary action create-action" title="Create" id="UploadButton">Upload Document</a> </td> <td class="cell zero-cell"></td> </tr>');
$("#UploadButton").click(function() {
      var directurl = "https://crimsondev.microsoftcrmportals.com/_portal/modal-form-template-path/7b138792-1090-45b6-9241-8f8d96d8c372?entityformid=f5127780-a296-e711-8103-70106faa6a31&languagecode=1033&refentity=ccl1000_application";
      directurl += "&refid=" + getUrlParam("id");
	  console.log(getUrlParam("id"));
      directurl += "&refrel=ccl1007_ccl1007_applicationdocument_ccl1000_appli";
      directurl += "&doctype=b56eafa4-4e9d-e711-8103-70106faaf8c1";//CV
         $("#CrimsonIframe").attr("src", directurl);
        var datapage = "/_portal/modal-form-template-path/7b138792-1090-45b6-9241-8f8d96d8c372";
        $("#CrimsonIframe").attr("data-page", datapage);
        //$('#CrimsonModal').modal({
       //   show: true,
       //   backdrop: 'static'
       // });
		$('#CrimsonModal').modal("show");
      });
	  
function getUrlParam(name) {
 var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)"); 
 var r = window.parent.location.search.substr(1).match(reg); 
 if (r != null) return unescape(r[2]); return null;
}
